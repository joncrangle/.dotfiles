# NOTE:
#   (`-')   (`-').-> (`-').->
#   ( OO).->( OO)_   (OO )__
# ,(_/----.(_)--\_) ,--. ,'-'
# |__,    |/    _ / |  | |  |
#  (_/   / \_..`--. |  `-'  |
#  .'  .'_ .-._)   \|  .-.  |
# |       |\       /|  | |  |
# `-------' `-----' `--' `--'
# ################################
# # EXPORT ENVIRONMENT VARIABLES #
# ################################

# XDG Base Directory Specification
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME=$XDG_CONFIG_HOME/.local/share
export XDG_STATE_HOME=$XDG_CONFIG_HOME/.local/state
export XDG_CACHE_HOME=$XDG_CONFIG_HOME/cache

# ZSH
export ZDOTDIR="$XDG_CONFIG_HOME/zsh"
export HISTFILE="$ZDOTDIR/.zsh_history"

# Mise
export MISE_DIR="$XDG_DATA_HOME/mise"

{{ if eq .chezmoi.os "darwin" -}}
# Homebrew
export HOMEBREW_DIR="/opt/homebrew"
export HOMEBREW_ZSH="/opt/homebrew/bin/zsh"
{{ end -}}

{{- if eq .chezmoi.os "darwin" }}
export SHELL="$HOMEBREW_ZSH"
{{ end -}}
export STARSHIP_CONFIG=$XDG_CONFIG_HOME/starship/starship.toml

# FZF
export FZF_DEFAULT_COMMAND="rg --files --no-ignore-vcs --hidden --follow --glob '!.git/' --glob '!.jj/' --color=always"
export FZF_DEFAULT_OPTS=" \
--color=bg+:#313244,bg:#1e1e2e,spinner:#f5e0dc,hl:#f38ba8 \
--color=fg:#cdd6f4,header:#f38ba8,info:#cba6f7,pointer:#f5e0dc \
--color=marker:#f5e0dc,fg+:#cdd6f4,prompt:#cba6f7,hl+:#f38ba8 \
--color=selected-bg:#45475a \
--multi \
--ansi \
--border=rounded \
--bind 'ctrl-f:preview-page-down,ctrl-b:preview-page-up'"
export FZF_CTRL_T_OPTS="
  --walker-skip .git,node_modules,target,.jj
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"
export FZF_ALT_C_OPTS="
  --walker-skip .git,node_modules,target,.jj
  --preview 'tree -C {}'"
{{ if eq .chezmoi.os "linux" }}
export FZF_CTRL_R_OPTS="--bind 'ctrl-y:execute-silent(echo -n {2..} | wl-copy)+abort'"
{{- else -}}
export FZF_CTRL_R_OPTS="--bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'"
{{- end }}

# Skim
export SKIM_PREVIEW_SHELL="$SHELL"
export SKIM_DEFAULT_OPTIONS="--color=catppuccin-mocha \
--border=rounded --bind 'ctrl-f:preview-page-down,ctrl-b:preview-page-up'"
export SKIM_DEFAULT_COMMAND="rg --files --no-ignore-vcs --hidden --follow --glob '!.git/' --glob '!.jj/'"
export SKIM_CTRL_T_COMMAND="$SKIM_DEFAULT_COMMAND --glob '!node_modules/' --glob '!target/'"
export SKIM_CTRL_T_OPTS="--ansi --preview 'bat -n --color=always {}' --bind 'ctrl-/:toggle-preview'"
export SKIM_ALT_C_COMMAND="fd --type d --hidden --follow --exclude .git --exclude .jj --exclude node_modules --exclude target"
export SKIM_ALT_C_OPTS="--ansi --preview 'eza --tree --color=always --icons {}'"
{{ if eq .chezmoi.os "linux" }}
export SKIM_CTRL_R_OPTS="--ansi --tiebreak=index --with-nth=4.. \
--bind 'ctrl-y:execute-silent(echo {4..} | wl-copy)+abort'"
{{- else -}}
export SKIM_CTRL_R_OPTS="--tiebreak=index --with-nth=4.. \
--bind 'ctrl-y:execute-silent(echo {4..} | pbcopy)+abort'"
{{- end }}

# Bat
export BAT_THEME="Catppuccin Mocha"

export GOOGLE_CLOUD_PROJECT="{{ .gcp_project_id }}"
export VERTEX_LOCATION=global
GCP_KEY="$HOME/.config/gcloud/key.json"
if [[ -f "$GCP_KEY" ]]; then
    export GOOGLE_APPLICATION_CREDENTIALS="$GCP_KEY"
fi

# Path
path=(
    $HOME/.config/.local/bin(N-/)
    $HOME/.local/bin(N-/)
    $HOME/bin(N-/)
    $MISE_DIR/shims(N-/)
    {{ if eq .chezmoi.os "darwin" -}}
    $HOMEBREW_DIR/bin(N-/)
    {{- end -}}
    {{- if eq .chezmoi.os "linux" -}}
    /usr/bin(N-/)
    $HOME/.config/hypr/scripts(N-/)
    {{ end }}
    $path
)
# vim: ft=zsh
